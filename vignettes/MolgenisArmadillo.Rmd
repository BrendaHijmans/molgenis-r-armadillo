---
title: "MolgenisArmadillo"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{MolgenisArmadillo}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---




```r
library(MolgenisArmadillo)
```

# Purpose
This library can be used by data managers to share datasets on a
MOLGENIS Armadillo server.
Researchers can then analyse these datasets and datasets shared on other servers
using DataSHIELD.

# Overview
The datasets are stored in shared folders on a MinIO file store. The MOLGENIS
Armadillo server has access to the file store and can load the data sets into
a shielded RServe environment so that researchers can call DataSHIELD analysis
methods on the data.

# Login
In order to access the files as a data manager, you need to log in.
The login method needs the URLs of the Armadillo server and the MinIO
server. It will open a browser window where you can identify yourself with
the ID provider.

```r
armadillo.login("https://armadillo.dev.molgenis.org",
      "https://armadillo-minio.dev.molgenis.org")
#> [1] "We're opening a browser so you can log in with code YDC2RJ"
#> No encoding supplied: defaulting to UTF-8.
```

It will create a session and store the credentials in the environment:

```r
Sys.getenv("AWS_S3_ENDPOINT")
#> [1] "armadillo-minio.dev.molgenis.org"
Sys.getenv("AWS_ACCESS_KEY_ID")
#> [1] "MKAWSE44EP2LGY6O7UEQ"
Sys.getenv("AWS_SECRET_ACCESS_KEY")
#> [1] "Iqe+dmvBD853xGhD+eJwj1Bx+p9yB1s0WQjLNKeY"
Sys.getenv("AWS_SESSION_TOKEN")
#> [1] "eyJhbGciOiJIUzUxMiIsInR5cCI6IkpXVCJ9.eyJhY2Nlc3NLZXkiOiJNS0FXU0U0NEVQMkxHWTZPN1VFUSIsImFwcGxpY2F0aW9uSWQiOiI3ODliOTQxNy1jYTJiLTQ3MDctYWI5Yy00NzEzNzNkOTFiYTAiLCJhdF9oYXNoIjoiVm43LWQ5c0ZxNURzc1lISVlrd3lyZyIsImF1ZCI6Ijc4OWI5NDE3LWNhMmItNDcwNy1hYjljLTQ3MTM3M2Q5MWJhMCIsImF1dGhlbnRpY2F0aW9uVHlwZSI6IlBBU1NXT1JEIiwiZW1haWwiOiJmbGV1ckBrZWxwaW4ubmwiLCJlbWFpbF92ZXJpZmllZCI6dHJ1ZSwiZXhwIjoiMTU5NDk5MjA0MCIsImlhdCI6MTU5NDk5MTE0MCwiaXNzIjoiaHR0cHM6Ly9hdXRoLm1vbGdlbmlzLm9yZyIsInBvbGljeSI6InJlYWR3cml0ZSIsInByZWZlcnJlZF91c2VybmFtZSI6ImZsZXVyIiwicm9sZXMiOlsiU1UiXSwic3ViIjoiODdmZjcyMTEtNTA1MC00NTY1LTkxMzctZjI1NDcyMDdjODUyIn0.LbcRDATc1x3spdFRkwSYrm1yeq31ch0XKNFZiKO9m94PHViNDjMxgBXaFngaXg_BG35ZB6CLCLphLxd2SXClRA"
getOption("MolgenisArmadillo.s3.use_https")
#> [1] TRUE
getOption("cloudyr.aws.default_region")
#> [1] ""
```

Now you can create a shared folder and upload datasets to it

```r
library(datasets)
armadillo.create_folder("shared.folder")
#> Created folder 'shared.folder'
armadillo.create_workspace("shared.folder", "test-data", iris, iris3)
#> Created workspace 'test-data'
```
